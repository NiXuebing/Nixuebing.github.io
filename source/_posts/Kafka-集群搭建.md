---
title: Kafka 学习笔记（一）
date: 2018-04-12 21:16:00
author: ACE NI
tags:
  - kafka
categories:
  - 高并发架构
---
# Kafka 简介

定位：分布式流处理平台。

3个关键特性

- 能够允许发布和订阅流数据。
- 存储流数据时提供相应的容错机制。
- 当流数据到达时能够被及时处理。

<!-- more -->

## 基本概念

1、 主题 Topic
​	
​    一组消息抽象归纳为一个主题

2、消息 Message

	kafka通信的基本单位，由一个固定长度的消息头和一个可变长度的消息体构成。

3、分区 Partition

	每个主题分成一个或多个分区，每个分区由一系列有序、不可变的消息组成，是一个有序队列。
	kafka只能保证一个分区之内消息的有序性。

4、副本 Replica

	每个分区在物理上对应一个文件夹，每个分区又有一至多个副本，分区的副本分布在集群的不同代理上，以提高可用性。


5、偏移量

	任何发布到分区的消息会被直接追加到日志文件的尾部，而每条消息在日志文件中的位置都会对应一个按序递增的偏移量。
	偏移量是一个分区下严格有序的逻辑值，不表示消息在磁盘上的物流位置。

6、日志段 LogSegment

	一个日志被分为多个日志段。日志段是Kafka日志对象分片的最小单位。

7、代理 Broker

	kafka实例称为代理 broker。

8、生产者 Producer

	生成者负责将消息发送给代理。

9、消费者 Consumer  消费组  ConsumerGroup

	消费者以拉取(pull)方式拉取数据。
	如果不指定消费组，则该消费者属于默认消费组(test-consumer-group)。
	同一个主题的一条消息只能被同一个消费组下某一个消费者消费，但不同消费组的消费者可同时消费该消息。



## Kafka特性

1、消息持久化

	以文件系统来存储数据，磁盘顺序追加，采用时间复杂度O(1)的磁盘结构，提供了常量时间的性能。

2、高吞吐量

	磁盘顺序读写，数据写入及数据同步采用了零拷贝技术，采用sendFile()函数调用，完全在内核中操作，支持数据压缩和批量发送。

3、扩展性

	依赖Zookeeper来对集群进行协调管理。

4、多客户端支持

5、Kafka Stream

6、安全机制

7、数据备份

8、轻量级

9、消息压缩

	支持Gzip、Snappy、LZ4 三种压缩方式，通常把多条消息放在一起组成MessageSet，然后在把MessageSet放到一条消息里面去，从而提高压缩比率进而提高吞吐量。













































